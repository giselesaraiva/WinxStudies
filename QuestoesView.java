package Testednv;

import java.awt.BorderLayout;
import java.awt.Component;
import java.awt.Container;
import java.awt.Dimension;
import java.awt.GridLayout;
import java.util.Enumeration;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import javax.swing.AbstractButton;
import javax.swing.ButtonGroup;
import javax.swing.JButton;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JRadioButton;
import javax.swing.JScrollPane;

public class QuestoesView extends javax.swing.JFrame {

    /**
     * Creates new form EscolhaQuestoes
     */
    public QuestoesView() {
    	
        initComponents();
        QuestoesController con = new QuestoesController(this);
         setExtendedState(MAXIMIZED_BOTH);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

    	
        jPanel1 = new javax.swing.JPanel();
        jLabel2 = new javax.swing.JLabel();
        MATEMATICA = new javax.swing.JButton();
        PORTUGUES = new javax.swing.JButton();
        LITERATURA = new javax.swing.JButton();
        FISICA = new javax.swing.JButton();
        QUIMICA = new javax.swing.JButton();
        BIOLOGIA = new javax.swing.JButton();
        GEOGRAFIA = new javax.swing.JButton();
        HISTORIA = new javax.swing.JButton();
        REDACAO = new javax.swing.JButton();
        btnFinalizar = new JButton("Finalizar");
        add(btnFinalizar, BorderLayout.SOUTH);
        btnFinalizar.setVisible(false);

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);

        jPanel1.setBackground(new java.awt.Color(255, 255, 255));

        jLabel2.setFont(new java.awt.Font("Segoe UI", 1, 60)); // NOI18N
        jLabel2.setForeground(new java.awt.Color(70, 136, 136));
        jLabel2.setText("SELECIONE A MATÉRIA:");

        MATEMATICA.setIcon(new javax.swing.ImageIcon("C:\\Users\\user\\Desktop\\FERNANDA ESCOLA 2023\\POO\\TesteLogin\\Mat.png")); // NOI18N
        MATEMATICA.setContentAreaFilled(false);
       

        PORTUGUES.setIcon(new javax.swing.ImageIcon("C:\\Users\\user\\Desktop\\FERNANDA ESCOLA 2023\\POO\\TesteLogin\\Portugues.png")); // NOI18N
        PORTUGUES.setContentAreaFilled(false);

        LITERATURA.setIcon(new javax.swing.ImageIcon("C:\\Users\\user\\Desktop\\FERNANDA ESCOLA 2023\\POO\\TesteLogin\\Literatura.png")); // NOI18N
        LITERATURA.setContentAreaFilled(false);
        

        FISICA.setIcon(new javax.swing.ImageIcon("C:\\Users\\user\\Desktop\\FERNANDA ESCOLA 2023\\POO\\TesteLogin\\Fisica.png")); // NOI18N
        FISICA.setContentAreaFilled(false);
        

        QUIMICA.setIcon(new javax.swing.ImageIcon("C:\\Users\\user\\Desktop\\FERNANDA ESCOLA 2023\\POO\\TesteLogin\\Quimica.png")); // NOI18N
        QUIMICA.setContentAreaFilled(false);
        

        BIOLOGIA.setIcon(new javax.swing.ImageIcon("C:\\Users\\user\\Desktop\\FERNANDA ESCOLA 2023\\POO\\TesteLogin\\Biologia.png")); // NOI18N
        BIOLOGIA.setContentAreaFilled(false);
        

        GEOGRAFIA.setIcon(new javax.swing.ImageIcon("C:\\Users\\user\\Desktop\\FERNANDA ESCOLA 2023\\POO\\TesteLogin\\Geografia.png")); // NOI18N
        GEOGRAFIA.setContentAreaFilled(false);
       

        HISTORIA.setIcon(new javax.swing.ImageIcon("C:\\Users\\user\\Desktop\\FERNANDA ESCOLA 2023\\POO\\TesteLogin\\Historia.png")); // NOI18N
        HISTORIA.setContentAreaFilled(false);
        

        REDACAO.setIcon(new javax.swing.ImageIcon("C:\\Users\\user\\Desktop\\FERNANDA ESCOLA 2023\\POO\\TesteLogin\\Redação.png")); // NOI18N
        REDACAO.setActionCommand("");
        REDACAO.setContentAreaFilled(false);
        

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jLabel2, javax.swing.GroupLayout.PREFERRED_SIZE, 1153, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(72, 72, 72)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(LITERATURA)
                    .addComponent(MATEMATICA)
                    .addComponent(PORTUGUES))
                .addGap(98, 98, 98)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(FISICA)
                    .addComponent(BIOLOGIA)
                    .addComponent(QUIMICA, javax.swing.GroupLayout.Alignment.LEADING))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 254, Short.MAX_VALUE)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(HISTORIA)
                    .addComponent(GEOGRAFIA)
                    .addComponent(REDACAO))
                .addGap(78, 78, 78))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(26, 26, 26)
                .addComponent(jLabel2)
                .addGap(121, 121, 121)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(MATEMATICA)
                    .addComponent(FISICA)
                    .addComponent(GEOGRAFIA))
                .addGap(50, 50, 50)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(QUIMICA)
                            .addComponent(PORTUGUES))
                        .addGap(57, 57, 57)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(LITERATURA)
                            .addComponent(BIOLOGIA)))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(HISTORIA)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(REDACAO)))
                .addContainerGap(295, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel1, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );

        pack();
        
    }// </editor-fold>//GEN-END:initComponents
    
    
    
    public void exibirQuestoes(List<QuestoesVO> questoesList) {
    	System.out.println("Funcionando");

    	jPanel1.removeAll();
    	jPanel1.setLayout(new GridLayout(0,1));
    	
        btnFinalizar.setVisible(true);

        
        buttonGroups = new HashMap<>();
        
        for (QuestoesVO questao : questoesList) {
            JLabel perguntaLabel = new JLabel(questao.getPergunta());
            jPanel1.add(perguntaLabel);

            JRadioButton radioButtonA = new JRadioButton(questao.getA());
            JRadioButton radioButtonB = new JRadioButton(questao.getB());
            JRadioButton radioButtonC = new JRadioButton(questao.getC());
            JRadioButton radioButtonD = new JRadioButton(questao.getD());
            JRadioButton radioButtonE = new JRadioButton(questao.getE());

            ButtonGroup buttonGroup = new ButtonGroup();
            buttonGroup.add(radioButtonA);
            buttonGroup.add(radioButtonB);
            buttonGroup.add(radioButtonC);
            buttonGroup.add(radioButtonD);
            buttonGroup.add(radioButtonE);

            buttonGroups.put(questao, buttonGroup);

            jPanel1.add(radioButtonA);
            jPanel1.add(radioButtonB);
            jPanel1.add(radioButtonC);
            jPanel1.add(radioButtonD);
            jPanel1.add(radioButtonE);
        }

        scrollpane = new JScrollPane(jPanel1);
        scrollpane.setPreferredSize(new Dimension(400, 400));
        scrollpane.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_ALWAYS);

        
        setLayout(new BorderLayout());
        add(scrollpane, BorderLayout.CENTER);
        add(btnFinalizar, BorderLayout.AFTER_LAST_LINE);

        jPanel1.revalidate();
        jPanel1.repaint();
        pontuacao = 0;
    }

    public int calcularPontuacao() {
        int pontuacao = 0;
        for (QuestoesVO questao : buttonGroups.keySet()) {
            ButtonGroup buttonGroup = buttonGroups.get(questao);
            String respostaSelecionada = getSelectedButtonText(buttonGroup);

            if (respostaSelecionada != null && respostaSelecionada.equals(questao.getResposta())) {
                pontuacao++;
            }
        }
        return pontuacao;
    }
    
    public String getSelectedButtonText(ButtonGroup buttonGroup) {
        Enumeration<AbstractButton> buttons = buttonGroup.getElements();
        while (buttons.hasMoreElements()) {
            AbstractButton button = buttons.nextElement();
            if (button.isSelected()) {
                return button.getActionCommand();
            }
        }
        return null;
    }
    
    public void mostrarPontuacao(int pontuacao) {
    	jPanel1.removeAll();
        JLabel pontuacaoLabel = new JLabel("Pontuação: " + pontuacao);
        jPanel1.add(pontuacaoLabel);
        jPanel1.revalidate();
        jPanel1.repaint();	
    }

    
    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(QuestoesView.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(QuestoesView.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(QuestoesView.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(QuestoesView.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                QuestoesDAO questoesDAO = new QuestoesDAO(); // Criar uma instância de QuestoesDAO
                new QuestoesView().setVisible(true);
            }
        });
    }

    private void limparJFrame(Container container) {
        Component[] components = container.getComponents();
        for (Component component : components) {
            if (component instanceof Container) {
                limparJFrame((Container) component);
            }
            container.remove(component);
        }
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    public javax.swing.JButton BIOLOGIA;
    public javax.swing.JButton FISICA;
    public javax.swing.JButton GEOGRAFIA;
    public javax.swing.JButton HISTORIA;
    public javax.swing.JButton LITERATURA;
    public javax.swing.JButton MATEMATICA;
    public javax.swing.JButton PORTUGUES;
    public javax.swing.JButton QUIMICA;
    public javax.swing.JButton REDACAO;
    public javax.swing.JLabel jLabel2;
    public javax.swing.JPanel jPanel1;
    public JButton btnFinalizar;
    private JScrollPane scrollpane;
    Map<QuestoesVO, ButtonGroup> buttonGroups;
    private QuestoesDAO questoesDAO;
    private int pontuacao;
    // End of variables declaration//GEN-END:variables
}